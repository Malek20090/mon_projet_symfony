{% extends 'base.html.twig' %}

{% block title %}Tous les Quiz{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link href="{{ asset('css/home.css') }}" rel="stylesheet">
{% endblock %}

{% block body %}
<!-- Hero Section -->
<section class="hero-section bg-gradient-success text-white py-5 mb-5 position-relative overflow-hidden">
    <div class="background-pattern"></div>
    <div class="container position-relative">
        <div class="row align-items-center">
            <div class="col-lg-8">
                <h1 class="display-4 fw-bold animate__animated animate__bounceIn">
                    <i class="fas fa-question-circle me-3 animate__animated animate__zoomIn animate__delay-1s"></i> Tous les Quiz
                </h1>
                <p class="lead animate__animated animate__fadeInLeft animate__delay-1s">
                    Testez vos connaissances en finance et évaluez votre progression avec nos quiz interactifs.
                </p>
                <div class="mt-4 animate__animated animate__fadeInUp animate__delay-2s">
                    <span class="badge bg-light text-success fs-6 px-3 py-2 me-2 animate__animated animate__pulse animate__infinite">
                        <i class="fas fa-brain"></i> Apprentissage Actif
                    </span>
                    <span class="badge bg-light text-success fs-6 px-3 py-2 animate__animated animate__pulse animate__infinite">
                        <i class="fas fa-trophy"></i> Défis & Récompenses
                    </span>
                </div>
            </div>
            <div class="col-lg-4 text-center animate__animated animate__zoomIn animate__delay-1s">
                <i class="fas fa-brain fa-6x text-white opacity-75 floating-icon"></i>
            </div>
        </div>
    </div>
</section>

<div class="container">
    <div class="text-center mb-5">
        <p class="text-muted">Choisissez un quiz et commencez votre défi !</p>
    </div>

    <div class="d-flex justify-content-center mb-4">
        <div class="dropdown">
            <button class="btn btn-outline-success dropdown-toggle" type="button" id="sortDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="fas fa-sort"></i> Trier par
            </button>
            <ul class="dropdown-menu" aria-labelledby="sortDropdown">
                <li><a class="dropdown-item" href="{{ path('student_quiz_index', { sort: 'question', order: (sortBy == 'question' and order == 'ASC') ? 'DESC' : 'ASC' }) }}">
                    Question {% if sortBy == 'question' %}<i class="fas fa-sort-{{ order == 'ASC' ? 'up' : 'down' }}"></i>{% endif %}
                </a></li>
                <li><a class="dropdown-item" href="{{ path('student_quiz_index', { sort: 'pointsValeur', order: (sortBy == 'pointsValeur' and order == 'ASC') ? 'DESC' : 'ASC' }) }}">
                    Points {% if sortBy == 'pointsValeur' %}<i class="fas fa-sort-{{ order == 'ASC' ? 'up' : 'down' }}"></i>{% endif %}
                </a></li>
            </ul>
        </div>
    </div>

    {% if quizzes|length > 0 %}
        <div class="row g-4">
            {% for quiz in quizzes %}
                <div class="col-md-6 col-lg-4 animate__animated animate__fadeInUp" style="animation-delay: {{ loop.index * 0.1 }}s;">
                    <div class="card h-100 shadow-sm border-0 hover-card">
                        <div class="card-header bg-gradient-success text-white text-center py-3">
                            <div class="d-flex justify-content-center align-items-center">
                                {% for i in 1..5 %}
                                    <i class="fas fa-star text-warning me-1" style="font-size: 0.8rem;"></i>
                                {% endfor %}
                            </div>
                            <small class="text-white-50">Quiz Challenge</small>
                        </div>
                        <div class="card-body d-flex flex-column">
                            <div class="mb-3">
                                {% if quiz.cours %}
                                    <span class="badge bg-primary text-white px-3 py-2 rounded-pill mb-2">
                                        <i class="fas fa-book me-1"></i> {{ quiz.cours.titre|slice(0, 25) }}{% if quiz.cours.titre|length > 25 %}...{% endif %}
                                    </span>
                                {% endif %}
                                <span class="badge bg-warning text-dark px-3 py-2 rounded-pill">
                                    <i class="fas fa-star me-1"></i> {{ quiz.pointsValeur }} point{{ quiz.pointsValeur > 1 ? 's' : '' }}
                                </span>
                            </div>

                            <h5 class="card-title text-dark fw-bold mb-3">
                                {{ quiz.question|slice(0, 90) }}{% if quiz.question|length > 90 %}...{% endif %}
                            </h5>

                            <div class="mb-3">
                                <div class="d-flex align-items-center text-muted">
                                    <i class="fas fa-list me-2"></i>
                                    <span>{{ quiz.choixReponses|length }} choix disponible{{ quiz.choixReponses|length > 1 ? 's' : '' }}</span>
                                </div>
                            </div>

                            <div class="mt-auto">
                                <a href="{{ path('student_quiz_pass', {'id': quiz.id}) }}" class="btn btn-success w-100 rounded-pill fw-bold">
                                    <i class="fas fa-play me-2"></i> Passer le quiz
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="text-center py-5">
            <i class="fas fa-question-circle fa-4x text-muted mb-3"></i>
            <h3 class="text-muted">Aucun quiz disponible</h3>
            <p class="text-muted">Les quiz seront bientôt disponibles.</p>
        </div>
    {% endif %}

    <div class="mt-5 text-center">
        <a href="{{ path('student_cours_index') }}" class="btn btn-primary me-2">
            <i class="fas fa-book"></i> Voir les cours
        </a>
        <a href="{{ path('student_cours_index') }}" class="btn btn-secondary">
            <i class="fas fa-arrow-left"></i> Retour à l'accueil
        </a>
    </div>
</div>

<style>
.bg-gradient-primary {
    background: linear-gradient(135deg, #1e3fa3 0%, #00cfff 100%);
}

.bg-gradient-success {
    background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
}

.hero-section {
    border-radius: 0 0 50px 50px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
}

.hover-card {
    transition: all 0.3s ease;
    border-radius: 15px;
    overflow: hidden;
}

.hover-card:hover {
    transform: translateY(-10px);
    box-shadow: 0 20px 50px rgba(40, 167, 69, 0.25) !important;
}

.card {
    border-radius: 15px;
}

.card-header {
    border-radius: 15px 15px 0 0 !important;
    border: none;
}

.empty-state-icon {
    animation: float 3s ease-in-out infinite;
}

@keyframes float {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-10px); }
}

@media (max-width: 768px) {
    .hero-section {
        border-radius: 0 0 30px 30px;
        padding: 3rem 0;
    }

    .display-4 {
        font-size: 2.5rem;
    }

    .fa-6x {
        font-size: 4rem;
    }
}
</style>
{% endblock %}
